# Сервис сокращения ссылок

Сервис для сокращения URL, созданный на базе FastAPI. Позволяет генерировать короткие ссылки, управлять ими и перенаправлять пользователей на оригинальные URL. Приложение также предоставляет статистику и функции для мониторинга состояния.

---

## Интересные факты
1. Переделал SQLlite на PostgreSQL 
2. Написал тесты short_url/tests.py 
3. Поднял графану для мониторинга
4. Завернул все это в контейнер и настроил volume c network
5. DockerHub https://hub.docker.com/r/nikitavoronovvvv/short_url/tags
---

## Картинки 
<img width="624" alt="image" src="https://github.com/user-attachments/assets/44d36d13-586a-4c8d-93ed-9fc11e691a1c" />


<img width="885" alt="image" src="https://github.com/user-attachments/assets/06463a0e-5867-4f69-9661-f99385c9208d" />

<img width="1815" alt="image" src="https://github.com/user-attachments/assets/eeb32557-086b-4ecf-863a-8fe7199e5598" />

<img width="1473" alt="image" src="https://github.com/user-attachments/assets/2aedfd22-df9a-4b2e-ada0-c4c30d6a6c24" />


## Возможности

- **Сокращение ссылок**: Генерация уникального короткого идентификатора для любой валидной ссылки.
- **Перенаправление по короткой ссылке**: Переход на оригинальный URL по короткой ссылке.
- **Управление ссылками**:
  - **Просмотр всех ссылок**: Получение списка всех сокращённых ссылок с их оригинальными адресами и временем создания.
  - **Обновление ссылок**: Замена оригинального URL, привязанного к короткому идентификатору.
  - **Удаление ссылок**: Удаление сокращённой ссылки из базы данных.
- **Статистика**: Просмотр информации о конкретной сокращённой ссылке.
- **Мониторинг состояния**: Проверка состояния сервиса с помощью специального эндпоинта.

---

## Эндпоинты

### Сокращение и перенаправление

1. **Сокращение ссылки**  
   **POST** `/shorten`  
   **Тело запроса**:  
   ```json
   {
     "url": "https://example.com"
   }
   ```  
   **Ответ**:  
   ```json
   {
     "short_url": "http://localhost:8000/abc123"
   }
   ```

2. **Перенаправление на оригинальный URL**  
   **GET** `/{short_id}`  
   Перенаправляет пользователя на оригинальный URL, связанный с указанным `short_id`.

---

### Управление

1. **Список всех ссылок**  
   **GET** `/list`  
   **Ответ**:  
   ```json
   [
     {
       "short_id": "abc123",
       "full_url": "https://example.com",
       "created_at": "2024-12-23T14:00:00Z"
     }
   ]
   ```

2. **Статистика для короткой ссылки**  
   **GET** `/stats/{short_id}`  
   **Ответ**:  
   ```json
   {
     "short_id": "abc123",
     "full_url": "https://example.com"
   }
   ```

3. **Обновление оригинальной ссылки**  
   **PUT** `/{short_id}`  
   **Тело запроса**:  
   ```json
   {
     "url": "https://updated-url.com"
   }
   ```  
   **Ответ**:  
   ```json
   {
     "detail": "URL обновлен",
     "short_id": "abc123",
     "full_url": "https://updated-url.com"
   }
   ```

4. **Удаление сокращённой ссылки**  
   **DELETE** `/{short_id}`  
   **Ответ**:  
   ```json
   {
     "detail": "Короткая ссылка удалена"
   }
   ```

---

### Прочее

1. **Мониторинг состояния**  
   **GET** `/health`  
   **Ответ**:  
   ```json
   {
     "status": "ok",
     "timestamp": "2024-12-23T14:00:00Z"
   }
   ```

2. **Информация о сервисе**  
   **GET** `/`  
   **Ответ**:  
   ```text
   Short url app сделанный Вороновым Никитой
   ```

---

## Установка и запуск

### Требования

fastapi
uvicorn
SQLAlchemy
pydantic
validators
pytest
psycopg2-binary

### Локальный запуск

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/your-repo/url-shortener.git
   cd url-shortener
   ```

2. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Запустите сервер**:
   ```bash
   uvicorn main:app --host 0.0.0.0 --port 8000 --reload
   ```

4. **Откройте сервис**:  
   Перейдите по адресу `http://localhost:8000`.

### Запуск с помощью Docker

1. **Создайте Docker-образ**:
   ```bash
   docker build -t url-shortener .
   ```

2. **Запустите контейнер**:
   ```bash
   docker run -d -p 8000:8000 --name url-shortener url-shortener
   ```

3. **Откройте сервис**:  
   Перейдите по адресу `http://localhost:8000`.

---

## Структура базы данных

В базе данных содержится одна таблица:

### `URLItem`

| Поле         | Тип        | Описание                        |
|--------------|------------|---------------------------------|
| `id`         | Integer    | Первичный ключ                 |
| `short_id`   | String     | Уникальный идентификатор ссылки |
| `full_url`   | String     | Оригинальный URL               |
| `created_at` | Timestamp  | Дата и время создания          |

---

## Лицензия

Этот проект лицензируется на условиях MIT License.

---

## Автор

**Воронов Никита**  
